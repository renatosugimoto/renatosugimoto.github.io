---
import BaseLayout from '../layouts/BaseLayout.astro';
import { SITE_TITLE, SITE_DESCRIPTION } from '../consts';
import { getCollection } from 'astro:content';

const posts = (await getCollection('blog'))
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf())
  .slice(0, 3); // Top 3 recent posts
---

<BaseLayout title={SITE_TITLE} description={SITE_DESCRIPTION}>
  <section class="flex flex-col-reverse items-center gap-8 py-12 md:flex-row md:gap-12 md:py-20">
    <div class="flex-1 space-y-4">
      <h1
        class="bg-gradient-to-r from-emerald-400 to-cyan-400 bg-clip-text text-4xl font-bold text-transparent md:text-5xl"
      >
        Hi, I'm Renato.
      </h1>
      <p class="text-xl text-zinc-300">System Architect, DevOps Engineer, and Developer.</p>
      <p class="max-w-prose leading-relaxed text-zinc-400">
        I write about software development, share tutorials, and explore new technologies. Welcome
        to my digital garden.
      </p>
      <div class="flex gap-4 pt-4">
        <a
          href="/blog"
          class="rounded-full bg-white px-6 py-2.5 font-bold text-zinc-950 transition-colors hover:bg-zinc-200"
        >
          Read the Blog
        </a>
        <a
          href="https://github.com/renatosugimoto"
          target="_blank"
          class="rounded-full bg-zinc-800 px-6 py-2.5 font-bold text-white transition-colors hover:bg-zinc-700"
        >
          GitHub
        </a>
      </div>
    </div>
    <div
      class="relative aspect-square w-48 overflow-hidden rounded-full border-4 border-white/5 bg-zinc-800 shadow-2xl md:w-64"
    >
      <!-- Ideally use the avatar from config, hardcoded for now based on known assets -->
      <img
        src="/assets/images/bio-photo.jpg"
        alt="Renato Sugimoto"
        class="h-full w-full object-cover"
      />
    </div>
  </section>

  <section class="border-t border-white/5 pt-12">
    <div class="mb-8 flex items-center justify-between">
      <h2 class="text-2xl font-bold">Recent Posts</h2>
      <a href="/blog" class="text-sm font-medium text-emerald-400 hover:text-emerald-300"
        >View all &rarr;</a
      >
    </div>

    <div class="grid gap-8 md:grid-cols-2 lg:grid-cols-3">
      {
        posts.map((post) => (
          <a
            href={`/${post.slug}/`}
            class="group hover-lift block overflow-hidden rounded-2xl border border-white/5 bg-zinc-900/50 transition-colors hover:border-white/10 hover:bg-zinc-900"
          >
            {post.data.heroImage && (
              <div class="aspect-video overflow-hidden">
                <img
                  src={post.data.heroImage}
                  alt=""
                  class="h-full w-full object-cover transition-transform duration-500 group-hover:scale-105"
                />
              </div>
            )}
            <div class="p-6">
              <div class="mb-2 text-xs text-zinc-500">
                {post.data.date.toLocaleDateString('en-US', {
                  year: 'numeric',
                  month: 'short',
                  day: 'numeric',
                })}
              </div>
              <h3 class="mb-2 text-lg font-bold transition-colors group-hover:text-emerald-400">
                {post.data.title}
              </h3>
              <p class="line-clamp-2 text-sm text-zinc-400">
                {post.data.description || post.data.excerpt}
              </p>
            </div>
          </a>
        ))
      }
    </div>
  </section>
</BaseLayout>
