---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { SITE_TITLE, SITE_DESCRIPTION } from '../../consts';
import { getCollection } from 'astro:content';

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.date.valueOf() - a.data.date.valueOf()
);
---

<BaseLayout title={`Blog - ${SITE_TITLE}`} description={SITE_DESCRIPTION}>
	<div class="max-w-3xl mx-auto">
		<h1 class="text-3xl font-bold mb-8">All Posts</h1>
		<div class="space-y-8">
			{posts.map((post) => (
				<article class="flex flex-col md:flex-row gap-6 md:items-center group">
					<div class="md:w-1/4 text-zinc-500 text-sm md:text-right font-mono">
						{post.data.date.toLocaleDateString('en-US', {
							year: 'numeric',
							month: 'short',
							day: 'numeric',
						})}
					</div>
					<div class="flex-1">
						<a href={`/${post.slug}/`} class="block group-hover:translate-x-1 transition-transform">
							<h2 class="text-xl font-bold mb-1 group-hover:text-emerald-400 transition-colors">
								{post.data.title}
							</h2>
							<p class="text-zinc-400 text-sm line-clamp-2">
								{post.data.description || post.data.excerpt}
							</p>
						</a>
					</div>
				</article>
			))}
		</div>
	</div>
</BaseLayout>
